-- a)
ALTER TABLE Księgowość.Pracownicy
ADD COLUMN kierunkowy VARCHAR(16);
UPDATE Księgowość.Pracownicy
SET kierunkowy=CONCAT('(+48)',telefon);

-- b)
UPDATE Księgowość.Pracownicy
SET kierunkowy=CONCAT(SUBSTRING(kierunkowy, 1, 8), '-', SUBSTRING(kierunkowy, 9, 3), '-', SUBSTRING(kierunkowy, 12, 3))

-- c)
SELECT UPPER(Nazwisko)
FROM Księgowość.Pracownicy
ORDER BY LENGTH(Nazwisko) DESC LIMIT 1

-- d)
SELECT MD5(Imie) AS Imie_MD5, MD5(Nazwisko) AS Nazwisko_MD5, MD5(Kwota::text) AS Pensja_MD5
FROM Księgowość.Pracownicy AS pra
JOIN Księgowość.Wynagrodzenie AS wyn
ON pra.ID_pracownika = wyn.ID_pracownika
JOIN Księgowość.Pensja AS pen
ON wyn.ID_pensji = pen.ID_pensji

-- f)
SELECT pra.Imie, pra.Nazwisko, pen.Kwota, pre.Kwota
FROM Księgowość.Pracownicy AS pra
LEFT OUTER JOIN Księgowość.Wynagrodzenie AS wyn
ON pra.ID_pracownika = wyn.ID_pracownika
LEFT OUTER JOIN Księgowość.Pensja AS pen
ON wyn.ID_pensji = pen.ID_pensji
LEFT OUTER JOIN Księgowość.Premia AS pre
ON wyn.ID_premii = pre.ID_premii

-- g)
SELECT CONCAT('Pracownik ', pra.Imie, ' ', pra.Nazwisko, ' w dniu ', wyn.Data, ' otrzymał pensję całkowitą na kwotę ',
			  (pen.Kwota + pre.Kwota + ((godz.Liczba_godzin - 160) * pen.Kwota)/160), ' zł, gdzie wynagrodzenie zasadnicze wynosiło: ', 
			  pen.Kwota, ' zł, premia: ', pre.Kwota, ' zł, nadgodziny: ', ((godz.Liczba_godzin - 160) * pen.Kwota)/160, ' zł')
FROM Księgowość.Pracownicy AS pra
LEFT OUTER JOIN Księgowość.Wynagrodzenie AS wyn
ON pra.ID_pracownika = wyn.ID_pracownika
LEFT OUTER JOIN Księgowość.Pensja AS pen
ON wyn.ID_pensji = pen.ID_pensji
LEFT OUTER JOIN Księgowość.Premia AS pre
ON wyn.ID_premii = pre.ID_premii
LEFT OUTER JOIN Księgowość.Godziny AS godz
ON wyn.ID_godziny = godz.ID_godziny






